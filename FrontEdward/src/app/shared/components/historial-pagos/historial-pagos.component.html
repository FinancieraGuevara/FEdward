<div class="historial-pagos backgroundcontainer">
  <div class="container">
    <h1 class="text-center text-warning mb-4">Préstamos Realizados</h1>

    <div *ngIf="prestamosCompletados.length > 0; else noData">
      <table class="table table-dark table-hover rounded">
        <thead class="text-warning">
          <tr>
            <th>N° Cronograma</th>
            <th>Nombre solicitante</th>
            <th>Cuotas</th>
            <th>Detalle</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let prestamo of prestamosCompletados; let i = index">
            <td>{{ prestamo.id }}</td>
            <td>{{ prestamo.username }}</td>
            <td>{{ prestamo.cuotas }}</td>
            <td>
              <button class="btn btn-outline-warning" (click)="mostrarDetalle(prestamo)">
                <i class="fa-solid fa-arrow-down"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Mensaje cuando no hay datos -->
    <ng-template #noData>
      <p class="text-center text-muted">No hay préstamos completados.</p>
    </ng-template>
    

    <div class="row mt-4" *ngIf="prestamoSeleccionado">
      <div class="col-md-4">
        <div class="card bg-dark text-light">
          <div class="card-body">
            <h3 class="card-title text-warning">Detalle del Préstamo</h3>
            <ul class="list-unstyled">
              <li><strong class="text-warning">N° de Cronograma:</strong> {{ prestamoSeleccionado.id }}</li>
              <li><strong>Moneda:</strong> Soles</li>
              <li><strong>Fecha de inicio:</strong> {{ prestamoSeleccionado.detallecuotas[0].fechaPago }}</li>
              <li><strong>Tasa de interés efectiva:</strong> {{ prestamoSeleccionado.interes| number:'1.2-2' }}%</li>
              <li><strong>Periodo:</strong> {{ prestamoSeleccionado.cuotas }} mes(es)</li>
              <li><strong class="text-warning">Monto Total a Pagar:</strong> S/. {{prestamoSeleccionado.totalpagar}}</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="col-md-8">
        <div class="card bg-dark text-light">
          <div class="card-body">
            <h3 class="card-title text-warning">Cronograma de Pagos</h3>
            <div class="table-responsive">
              <table class="table table-dark table-hover">
                <thead class="text-warning">
                  <tr>
                    <th>N° Cuota</th>
                    <th>Fecha de Pago</th>
                    <th>Cuota</th>
                    <th>Interés</th>
                    <th>Saldo Final</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let cronograma of prestamoSeleccionado.detallecuotas">
                    <td>{{ cronograma.nmrcuota }}</td>
                    <td>{{ cronograma.fechaPago}}</td>
                    <td>S/. {{ cronograma.cuota | number:'1.2-2' }}</td>
                    <td>S/. {{ cronograma.interes | number:'1.2-2' }}</td>
                    <td>S/. {{ cronograma.saldofinal | number:'1.2-2' }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-4">
      <hr class="border-dark opacity-50">
      <p class="text-end text-warning fst-italic fw-semibold">Copyright © 2024, All rights reserved.</p>
    </div>
  </div>
</div>